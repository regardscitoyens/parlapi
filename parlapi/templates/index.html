<!doctype html>
<head>
  <title>ParlAPI</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" />
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}" />
</head>
<body>
  <section class="container-fluid">
    <header class="col-md-12 page-header">
      <img src="{{ url_for('static', filename='parlapi.png') }}" class="pull-right" style="margin-top: 1em;">
      <h1>Bienvenue sur ParlAPI</h1>
      <article class="alert alert-info">
        <p><b>L'objectif de ParlAPI est de fournir une API réellement utilisable sur l'Open Data parlementaire.</b></p>
        <p>Les données proviennent des portails Open Data parlementaires :</p>
        <p>
          <ul>
            <li><a href="http://data.assemblee-nationale.fr/" target="_blank">data.assemblee-nationale.fr</a></li>
            <li><a href="http://data.senat.fr/" target="_blank">data.senat.fr</a></li>
          </ul>
        </p>

        <p>Ce service a été conçu de manière à respecter le plus fidèlement possible le schéma de données des sources parlementaires.  En particulier, aucune donnée calculée n'est ajoutée au modèle.</p>
      </article>
    </header>
    <div class="col-md-6">
      <article class="alert alert-danger"><b>Attention :</b> cette API est encore incomplête et son format n'est pas définitif.</article>

      <section class="panel panel-default">
        <header class="panel-heading">
          API REST
        </header>
        <article class="panel-body">
          <p>L'API REST donne accès en lecture seule aux données au format JSON.</p>


          <p>Les points d'entrée vers les listes d'objets sont décrits ci-dessous.  Les objets JSON renvoyés par l'API comprennent des hyperliens vers d'autres sections de l'API (notamment, les items de liste comportent toujours un lien vers une version plus détaillée).</p>
        </article>
        <table class="table table-striped table-responsive">
          <tr>
            <th>Description</th>
            <th>Point d'entrée API</th>
          </tr>
          {% for table, description in api.items() %}
            <tr>
              <td>{{ description }}</td>
              <td>
                <a href="{{ api_prefix }}{{ table }}">{{ api_prefix }}{{ table }}</a>
              </td>
            </tr>
          {% endfor %}
        </table>
      </section>
    </div>
    <div class="col-md-6">
      <section class="panel panel-default">
        <header class="panel-heading">
          Sources de données
        </header>
        <article class="panel-body">
          <p>Le tableau ci-dessous montre les travaux d'import des données et le résultat de leur dernière exécution.</p>
        </article>
        <table class="table table-striped table-responsive">
          <tr>
            <th>Source</th>
            <th>Dernière exécution</th>
            <th>État</th>
            <th>Fichier source</th>
            <th>Date fichier source</th>
          </tr>
          {% for job in jobs %}
            <tr>
              <td>{{ job.nom }}</td>
              <td>{{ job.date_exec }}</td>
              <td>
                {% if job.resultat == 'ok' %}
                  <span class="label label-success">OK</span>
                {% else %}
                  <span class="label label-danger">{{ job.resultat }}</span>
                {% endif %}
              </td>
              <td><a href="{{ job.url_fichier }}" target="_blank">fichier</a></td>
              <td>{{ job.date_fichier }}</td>
            </tr>
          {% endfor %}
        </table>
      </section>
    </div>
  </section>

  <footer class="well text-center">
    <small>
      <p>ParlAPI est un <a href="https://github.com/njoyard/parlapi" target="_blank">logiciel libre</a>,
      distribué sous <a href="https://www.gnu.org/licenses/agpl-3.0.html" target="_blank">license AGPLv3</a> &mdash;
        Les données sont réutilisables sous license
        <a href="http://creativecommons.org/licenses/by-sa/2.0/fr/" target="_blank">
          <img src="https://i.creativecommons.org/l/by-sa/2.0/fr/80x15.png" alt="CC-BY-SA">
        </a>
        et <a href="http://opendatacommons.org/licenses/odbl/">ODbL</a>.</p>

      <p>
        Vous êtes libre de réutiliser, modifier et recouper les données dans la mesure où vous indiquez leur source et que vous republiez les données modifiées ayant servi lors d'une réutilisation publiée.
      </p>
    </small>
  </footer>
</body>
